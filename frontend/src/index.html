<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link
      href="https://fonts.googleapis.com/css?family=Keania One"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Acme&display=swap"
      rel="stylesheet"
    />
    <link href="./styles.css" rel="stylesheet" />
    <style>
      #enviroment {
        position: absolute;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        padding: 0;
      }
      /* #gameWindow {
        width: 96vw;
        height: 96vh;
        position: absolute;
        top: 2vh;
        left: 2vw;
        display: none;
        background: #ffffff;
        border: 2px solid white;
        box-sizing: content-box;
      } */
    </style>
  </head>

  <!-- Animated background -->

  <div id="enviroment"></div>

  <!-- Game window -->

  <div id="gameWindow"></div>

  <body>
    <!-- Header -->

    <section id="lobby">
      <div class="navigation-header-container" id="header">
        <div class="navigation-header-wrapper">
          <div class="navigation-header-logo">
            <h1 class="navigation-header-logo-text">P</h1>
            <img
              loading="lazy"
              src="./assets/app_logo.png"
              alt="App Logo"
              class="app-logo"
            />
            <h1 class="navigation-header-logo-text">NG</h1>
          </div>
          <div class="navigation-header-content">
            <p class="navigation-header-item" onclick="goToHomeNavigation()">
              HOME
            </p>
            <p class="navigation-header-item" onclick="goToAboutNavigation()">
              ABOUT
            </p>
            <p
              class="navigation-header-item"
              onclick="goToSettingsNavigation()"
            >
              SETTINGS
            </p>
          </div>
        </div>
      </div>

      <!-- Add player boxes -->

      <div class="homeLeft half" id="player-panels-container"></div>

      <!-- Recent matches -->

      <div class="homeRight half">
        <div class="matches-container">
          <div class="matches-card">
            <h2 class="matches-title">Recent matches</h2>
            <article class="matches-list">
              <ul class="match-results">
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">Vladimir</span> beat Max [11 : 0]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">Max</span> beat Alex [11 : 6]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">Leo</span> beat Robert [12 : 10]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">Max</span> beat Robert [11 : 1]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">David</span> beat Max [11 : 8]
                  </p>
                </li>
                <li class="match-result match-result-large">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">David</span> beat Vladimir [14 :
                    12]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">David</span> beat Max [11 : 7]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">David</span> beat Max [11 : 7]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">David</span> beat Max [11 : 7]
                  </p>
                </li>
                <li class="match-result">
                  <p onclick="goToMatchView()" class="match-link">
                    <span class="winner-name">David</span> beat Max [11 : 7]
                  </p>
                </li>
              </ul>
            </article>
            <div
              class="matches-scrollbar"
              role="scrollbar"
              aria-orientation="vertical"
            ></div>
          </div>
        </div>

        <!-- Tournaments info -->

        <div class="tournament-container">
          <article class="tournament-card">
            <h2 class="tournament-title">Tournaments</h2>
            <div class="tournament-content">
              <a href="#">
                <img
                  loading="lazy"
                  src="./assets/left_triangle_arrow.svg"
                  alt=""
                  class="tournament-icon"
                />
              </a>
              <div class="tournament-details">
                <a href="#" class="tournament-link"> Transcendence Cup 2024 </a>
                <br />
                Status: <span class="status-completed">completed</span>
                <br />
                Winner: Max
                <br />
                Runner-up: Alex
                <br />
                Created: <span class="date-text">25/02/2024</span>
                <br />
                Ended: <span class="date-text">27/02/2024</span>
                <br />
              </div>
              <a href="#">
                <img
                  loading="lazy"
                  src="./assets/right_triangle_arrow.svg"
                  alt=""
                  class="tournament-icon"
                />
              </a>
            </div>
          </article>
        </div>

        <!-- Game creation buttons -->

        <div class="buttonContainer">
          <button
            onclick="goToGameStart()"
            class="create-action"
            tabindex="0"
            aria-label="Create Single Game"
          >
            CREATE SINGLE GAME
          </button>
          <button
            onclick="openTournamentSetupBox()"
            class="create-action"
            tabindex="0"
            aria-label="Create Single Game"
          >
            CREATE TOURNAMENT
          </button>
          <button
            onclick=""
            class="create-action"
            tabindex="0"
            aria-label="Create Single Game"
          >
            CREATE 4-PONG TOURNAMENT
          </button>
        </div>
      </div>

      <!-- Sign in -->

      <div class="signin box">
        <div class="register-container">
          <form class="register-form-wrapper">
            <header class="header-container">
              <p onclick="goToLobby()" class="animation">
                <img src="./assets/back_arrow.svg" alt="" />
              </p>
              <h1 class="title">Sign in</h1>
            </header>

            <input
              type="text"
              id="signInUsername"
              class="form-input"
              placeholder="username"
            />

            <input
              type="password"
              id="signInPassword"
              class="form-input"
              placeholder="password"
            />

            <div class="button-wrapper">
              <button
                type="button"
                class="submit-button"
                onclick="requestLoginButton()"
              >
                Sign in
              </button>
            </div>

            <div class="prompt-not-a-member">
              <span class="prompt-text">Not a member yet?</span>
              <a href="#" class="reg-link" onclick="goToSignup()">Sign up</a>
            </div>

            <hr class="divider" />

            <div class="prompt-oauth">
              <span class="prompt-text">Sign in with 42 account</span>
            </div>

            <a href="#" class="oauth-logo">
              <img
                src="./assets/42_api_logo.png"
                alt="42 Logo"
                class="oauth-logo"
              />
            </a>
          </form>
        </div>
      </div>

      <!-- Sign-up -->

      <div class="signup box">
        <div class="register-container">
          <form class="register-form-wrapper">
            <header class="header-container">
              <p onclick="goToLobby()" class="animation">
                <img src="./assets/back_arrow.svg" alt="" />
              </p>
              <h1 class="title">Sign up</h1>
            </header>

            <input
              type="text"
              id="displayName"
              class="form-input"
              placeholder="display name"
            />

            <input
              type="text"
              id="signUpUsername"
              class="form-input"
              placeholder="username"
            />

            <input
              type="password"
              id="signUpPassword"
              class="form-input"
              placeholder="password"
            />

            <div class="button-wrapper">
              <button
                type="button"
                class="submit-button"
                onclick="requestSignUp()"
              >
                Sign up
              </button>
            </div>

            <div class="prompt">
              <span class="prompt-text">Already have an account?</span>
              <a href="#" class="reg-link" onclick="goToSignin()">Sign in</a>
            </div>

            <hr class="divider" />

            <div class="prompt-oauth">
              <span class="prompt-text">Sign up with 42 account</span>
            </div>

            <a href="#" class="oauth-logo">
              <img
                src="./assets/42_api_logo.png"
                alt="42 Logo"
                class="oauth-logo"
              />
            </a>
          </form>
        </div>
      </div>

      <!-- Recent matches detailed stats -->

      <div class="matchView box half">
        <div class="match-stats">
          <div class="match-stats-header">
            <header class="match-stats-header-wrapper">
              <p onclick="goToHomeRight()" class="animation">
                <img src="./assets/back_arrow.svg" alt="" />
              </p>
              <h1 class="match-stats-title-top">Match statistics</h1>
            </header>
          </div>
          <div class="match-stats-result">
            <div class="match-stats-text-format">
              <span>Vladimir</span>
              <span>11</span>
            </div>
            <div class="match-stats-text-format">
              <span>Max</span>
              <span>0</span>
            </div>
          </div>
          <div class="match-stats-result match-stats-time-info">
            <div class="match-stats-text-format">
              <span>Match time:</span>
              <span>05m 26sec</span>
            </div>
            <div class="match-stats-text-format">
              <span>Date:</span>
              <span>10/05/2024</span>
            </div>
          </div>
          <div class="match-stats-header-no-arrow">
            <h1 class="match-stats-title">H2H</h1>
          </div>
          <div class="match-stats-result">
            <div class="match-stats-text-format">
              <span>Vladimir</span>
              <span class="match-stats-match-score">7:4</span>
              <span>Max</span>
            </div>
          </div>
          <div class="match-stats-header-no-arrow">
            <h1 class="match-stats-title">H2H matches</h1>
          </div>
          <div class="match-stats-scroll-container">
            <ul class="match-stats-list">
              <li class="match-stats-text-format">
                <span>Vladimir</span>
                <span class="match-stats-match-score">11:2</span>
                <span>Max</span>
              </li>
              <li class="match-stats-text-format">
                <span>Max</span>
                <span class="match-stats-match-score">9:11</span>
                <span>Vladimir</span>
              </li>
              <li class="match-stats-text-format">
                <span>Vladimir</span>
                <span class="match-stats-match-score">4:11</span>
                <span>Max</span>
              </li>
              <li class="match-stats-text-format">
                <span>Vladimir</span>
                <span class="match-stats-match-score">13:11</span>
                <span>Max</span>
              </li>
              <li class="match-stats-text-format">
                <span>Max</span>
                <span class="match-stats-match-score">10:12</span>
                <span>Vladimir</span>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Single game -->

    <section style="display: none" id="gameStart">
      <div class="single-game-lobby">
        <div class="single-game-top">
          <div class="single-game-grid-left"></div>
          <div class="single-game-vs-logo">
            <img
              class="single-game-vs-logo-props"
              src="./assets/vs_logo.png"
              alt="Versus logo"
            />
          </div>
          <div class="single-game-grid-right"></div>
        </div>
        <div class="single-game-bottom">
          <button
            class="single-game-buttons back"
            tabindex="0"
            onclick="goToHome()"
          >
            Back to menu
          </button>
          <button
            class="single-game-buttons clear-selection"
            tabindex="0"
            onclick="resetAll()"
          >
            Clear selection
          </button>
          <button
            class="single-game-buttons randomize"
            tabindex="0"
            onclick="randomizeChoice()"
          >
            Randomize
          </button>
          <button
            class="single-game-buttons start"
            tabindex="0"
            onclick="startOff()"
          >
            Start match
          </button>
        </div>
      </div>
    </section>

    <!-- Container for 2v2 game -->

    <section style="display: none" id="2v2GameStart">
      <div class="gameStartView">
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
        <img class="vsImage" src="./assets/vs_logo.png" />
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
        <div class="gameStartPlayer box">
          <div class="gameStartSelectable">
            <img
              src="./assets/default_avatar.png"
              alt="default_avatar"
              class="gameStartPlayerAvatar"
            />
            <h2 class="gameStartPlayerDisplayName">Test1</h2>
          </div>
        </div>
      </div>
      <div class="gameButtonContainer">
        <button onclick="goToHome()">Go back</button>
        <button>Randomize</button>
        <button onclick="">Start game</button>
      </div>
    </section>

    <!-- Profile window (WIP) -->

    <section style="display: none" id="profile">
      <div class="profile box">
        profile
        <button onclick="goToHome()">go back</button>
      </div>
    </section>

    <!-- Tournament pop up window setup -->

    <div class="tournament-setup" id="tournamentSetup">
      <div class="tournament-setup-name">
        <input
          type="text"
          id="tournamentName"
          class="tournament-setup-name-input"
          placeholder="Enter the tournament name"
          aria-label="Enter the tournament name"
        />
      </div>
      <!-- <div class="tournament-setup-header-container">
        <h1 class="tournament-setup-header">Add users to the tournament</h1>
      </div>
      <div class="tournament-setup-grid">
        <div class="game-player-card tournament">
          <article class="game-player-card-inner">
            <img
              loading="lazy"
              src="./assets/default_avatar.png"
              alt="Player avatar"
              class="tournament-setup-avatar"
            />
            <h3 class="tournament-setup-player-name">TestUserName1</h3>
          </article>
        </div>
        <div class="game-player-card tournament">
          <article class="game-player-card-inner">
            <img
              loading="lazy"
              src="./assets/default_avatar.png"
              alt="Player avatar"
              class="tournament-setup-avatar"
            />
            <h3 class="tournament-setup-player-name">TestUserName2</h3>
          </article>
        </div>
        <div class="game-player-card tournament">
          <article class="game-player-card-inner">
            <img
              loading="lazy"
              src="./assets/default_avatar.png"
              alt="Player avatar"
              class="tournament-setup-avatar"
            />
            <h3 class="tournament-setup-player-name">TestUserName3</h3>
          </article>
        </div>
        <div class="game-player-card tournament">
          <article class="game-player-card-inner">
            <img
              loading="lazy"
              src="./assets/default_avatar.png"
              alt="Player avatar"
              class="tournament-setup-avatar"
            />
            <h3 class="tournament-setup-player-name">TestUserName4</h3>
          </article>
        </div>
      </div> -->
      <div class="tournament-setup-buttons selection">
        <button
          class="tournament-setup-buttons button back"
          tabindex="0"
          onclick="goToLobby()"
        >
          Back
        </button>
        <button
          class="tournament-setup-buttons button continue"
          tabindex="0"
          onclick="goToTournament()"
        >
          Continue
        </button>
      </div>
    </div>

    <!-- Overlay to protect background buttons from accident push -->

    <div id="overlay"></div>

    <!-- Tournament main container -->

    <div class="tournament-main" id="tournament">
      <div class="tournament-top">
        <div class="tournament-top-left">
          <div class="tournament-name" id="tournamentTitle">
            <h1 class="tournament-name-text">Transcendence Cup 2024</h1>
          </div>
          <div class="tournament-grid"></div>
        </div>
        <div class="tournament-top-right">
          <h2 class="tournament-round h2" id="firstSemifinal">Semifinal 1</h2>

          <!-- Tournament SF1 -->

          <div
            class="tournament-match-container"
            id="firstSemifinalContent"
          ></div>

          <h2 class="tournament-round h2" id="secondSemifinal">Semifinal 2</h2>

          <!-- Tournament SF2 -->

          <div
            class="tournament-match-container"
            id="secondSemifinalContent"
          ></div>

          <!-- Footer buttons -->

          <h2 class="tournament-round h2" id="final">Final</h2>
        </div>
      </div>
      <div class="tournament-buttons lobby">
        <button
          class="tournament-buttons button back-to-menu"
          tabindex="0"
          id="backToMenu"
          onclick="goToLobby()"
        >
          Back to menu
        </button>
        <button
          class="tournament-buttons button generate"
          tabindex="0"
          id="generateSF"
          onclick="showSemiFinalButton()"
        >
          Generate bracket
        </button>
        <button
          class="tournament-buttons button start-sf-1"
          tabindex="0"
          id="startFirstSF"
          onclick="startOff()"
        >
          Start first SF
        </button>
      </div>
    </div>

    <script>
      /* Collection of all the buttons that transition the views */
      /* adding history, that is stored in the urlparameters */
      const views = {
        signup: goToSignup,
        signin: goToSignin,
        lobby: goToLobby,
        matchView: goToMatchView,
        home: goToHome,
        gamestart: goToGameStart,
        tournament: goToTournament,
        profile: goToProfile,
        homenavigation: goToHomeNavigation,
        settingsnavigation: goToSettingsNavigation,
        aboutnavigation: goToAboutNavigation,
      };

      window.addEventListener("popstate", (e) => {
        if (history.state == null) history.replaceState({ view: "home" });
        views[history.state["view"]]();
      });

      const updateHistory = (f) => {
        Object.entries(views).forEach((key) => {
          if (key[1] == f) {
            history.pushState({ view: key[0] }, "");
            console.log(key[0]);
          }
        });
      };

      /* home screen transitions */

      const homeLeft = document.getElementsByClassName("homeLeft")[0];
      const homeRight = document.getElementsByClassName("homeRight")[0];

      const signup = document.getElementsByClassName("signup")[0];
      const signin = document.getElementsByClassName("signin")[0];

      const matchView = document.getElementsByClassName("matchView")[0];

      /* section transitions */
      const lobby = document.getElementById("lobby");
      const gameStart = document.getElementById("gameStart");
      // const singleGameSettings = document.getElementById("singleGameSettings");
      const tournament = document.getElementById("tournament");
      const profile = document.getElementById("profile");
      const tournamentSetup = document.getElementById("tournamentSetup");
      const otherGameStart = document.getElementById("2v2GameStart");

      const header = document.getElementById("header");

      /* overlay to protect background buttons from being accidentally clicked */
      const overlay = document.getElementById("overlay");

      /* tournament transitions */
      const firstSemifinal = document.getElementById("firstSemifinal");
      const secondSemifinal = document.getElementById("secondSemifinal");
      const firstSemifinalContent = document.getElementById(
        "firstSemifinalContent"
      );
      const secondSemifinalContent = document.getElementById(
        "secondSemifinalContent"
      );
      const final = document.getElementById("final");
      const generateSFButton = document.getElementById("generateSF");
      const startFirstSemifinalButton = document.getElementById("startFirstSF");

      function goToSignup() {
        goToHomeNoHistory();
        homeLeft.style.display = "none";
        signin.style.display = "none";
        signup.style.display = "block";
        updateHistory(goToSignup);
      }

      function goToSignin() {
        goToHomeNoHistory();
        homeLeft.style.display = "none";
        signin.style.display = "block";
        signup.style.display = "none";
        updateHistory(goToSignin);
      }

      function goToLobby() {
        goToHomeNoHistory();
        homeLeft.style.display = "grid";
        signin.style.display = "none";
        signup.style.display = "none";
        updateHistory(goToLobby);
      }

      function goToMatchView() {
        goToHomeNoHistory();
        matchView.style.display = "block";
        homeRight.style.display = "none";
        updateHistory(goToMatchView);
      }

      function goToHomeRight() {
        goToHomeNoHistory();
        matchView.style.display = "none";
        homeRight.style.display = "grid";
        updateHistory(goToHomeRight);
      }

      function goToHomeNoHistory() {
        lobby.style.display = "block";
        gameStart.style.display = "none";
        // singleGameSettings.style.display = "none";
        tournament.style.display = "none";
        profile.style.display = "none";
        tournamentSetup.style.display = "none";
        overlay.style.display = "none";
      }

      function goToHome() {
        goToHomeNoHistory();
        resetAll();
        updateHistory(goToHome);
      }

      function runGame() {
        lobby.style.display = "none";
        gameStart.style.display = "none";
        tournament.style.display = "none";
        profile.style.display = "none";
        tournamentSetup.style.display = "none";
        overlay.style.display = "none";
        updateHistory(runGame);
      }

      // function goToSingleGameSettings() {
      //   singleGameSettings.style.display = "block";
      //   overlay.style.display = "block";
      //   overlay.style.pointerEvents = "auto";
      // }

      function goToGameStart() {
        lobby.style.display = "none";
        gameStart.style.display = "block";
        tournament.style.display = "none";
        // singleGameSettings.style.display = "none";
        profile.style.display = "none";
        overlay.style.display = "none";
        otherGameStart.style.display = "none";
        renderGameStart();
        updateHistory(goToGameStart);
      }

      function goToTournament() {
        lobby.style.display = "none";
        gameStart.style.display = "none";
        overlay.style.display = "none";
        profile.style.display = "none";
        tournamentSetup.style.display = "none";
        tournament.style.display = "block";
        generateSFButton.style.display = "block";
        startFirstSemifinalButton.style.display = "none";
        firstSemifinal.style.display = "flex";
        secondSemifinal.style.display = "flex";
        firstSemifinalContent.style.display = "none";
        secondSemifinalContent.style.display = "none";
        createTournament();
        // const cards = document.querySelectorAll(".game-player-card-inner");

        // cards.forEach((card) => {
        //   card.classList.remove("selected");
        //   card.classList.remove("shaded");
        // });
        updateHistory(goToTournament);
      }

      function goToProfile() {
        lobby.style.display = "none";
        gameStart.style.display = "none";
        tournament.style.display = "none";
        profile.style.display = "block";
        updateHistory(goToProfile);
      }

      function goTo2v2GameStart() {
        lobby.style.display = "none";
        gameStart.style.display = "none";
        tournament.style.display = "none";
        profile.style.display = "none";
        otherGameStart.style.display = "block";
      }

      function goToHomeNavigation() {
        homeLeft.style.display = "grid";
        homeRight.style.display = "grid";
        updateHistory(goToHomeNavigation);
      }

      function goToAboutNavigation() {
        homeLeft.style.display = "none";
        homeRight.style.display = "none";
        signin.style.display = "none";
        signup.style.display = "none";
        matchView.style.display = "none";
        updateHistory(goToAboutNavigation);
      }

      function goToSettingsNavigation() {
        homeLeft.style.display = "none";
        homeRight.style.display = "none";
        signin.style.display = "none";
        signup.style.display = "none";
        matchView.style.display = "none";
        updateHistory(goToSettingsNavigation);
      }

      function openTournamentSetupBox() {
        tournamentSetup.style.display = "block";
        overlay.style.display = "block";
        overlay.style.pointerEvents = "auto";
      }

      function showSemiFinalButton() {
        firstSemifinal.style.display = "none";
        secondSemifinal.style.display = "none";
        firstSemifinalContent.style.display = "block";
        secondSemifinalContent.style.display = "block";
        generateSFButton.style.display = "none";
        startFirstSemifinalButton.style.display = "block";
      }

      window.addEventListener("DOMContentLoaded", () => {
        const navItems = document.querySelectorAll(".navigation-header-item");
        navItems[0].classList.add("active");
      });

      document.querySelectorAll(".navigation-header-item").forEach((item) => {
        item.addEventListener("click", () => {
          document.querySelectorAll(".navigation-header-item").forEach((i) => {
            i.classList.remove("active");
          });
          item.classList.add("active");
        });
      });
    </script>
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@v0.149.0/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@v0.149.0/examples/jsm/"
        }
      }
    </script>
    <script>
      /* Players selector for tournament pre-setup */

      document.addEventListener("DOMContentLoaded", () => {
        const cards = document.querySelectorAll(".game-player-card-inner");

        cards.forEach((card) => {
          card.addEventListener("click", () => {
            if (card.classList.contains("selected")) {
              card.classList.remove("selected");
            } else {
              card.classList.add("selected");
            }

            const anySelected = Array.from(cards).some((c) =>
              c.classList.contains("selected")
            );

            cards.forEach((c) => {
              if (anySelected) {
                if (c.classList.contains("selected")) {
                  c.classList.remove("shaded");
                } else {
                  c.classList.add("shaded");
                }
              } else {
                c.classList.remove("shaded");
              }
            });
          });
        });
      });
    </script>
    <script type="module" src="./base.js"></script>
    <script type="module" src="./main.js"></script>
    <script src="./scripts.js"></script>
    <script>
      /* Game start */

      let gameWindow = document.getElementById("gameWindow");
      function startOff() {
        //const newElement = gameWindow.cloneNode(true); // Clone the element
        //gameWindow.parentNode.replaceChild(newElement, gameWindow); // Replace it
        //gameWindow.innerHTML = "";
        gameWindow.style.display = "block";
        runGame();
        // ai = 2 two AIs: AI vs god level AI
        // ai = 1 one AI vs human
        // ai = 0 two humans
        // ai = -2 four humans
        let result = startGame(0);
        console.log("index.html result from startGame=", result);
        //document.getElementById("gameStartButton").blur();
        //document.getElementById("gameStartButton").disabled = true;
        //gameWindow.style.display = "none"
      }

      // function resetGameState() {
      // 	// Add code here to reset game variables, clear game window, etc.
      // 	 // Example: clearing game content
      // 	 gameWindow.innerHTML = "";
      // }
    </script>
    <script>
      /* Single game players pick */

      document.addEventListener("DOMContentLoaded", function () {
        const leftGrid = document.querySelector(".single-game-grid-left");
        const rightGrid = document.querySelector(".single-game-grid-right");
        const startButton = document.querySelector(
          ".single-game-buttons.start"
        );
        let leftSelectedIndex = null;
        let playersSelected = 0;

        function updateStartButton() {
          startButton.disabled = playersSelected !== 2;
          startButton.style.opacity = playersSelected === 2 ? "1" : "0.5";
          startButton.style.cursor =
            playersSelected === 2 ? "pointer" : "not-allowed";
        }

        // Reset all selections
        function resetAll(leftPlayers, rightPlayers) {
          playersSelected = 0;
          leftSelectedIndex = null;
          leftPlayers.forEach((p) => {
            p.classList.remove("player-disabled", "player-selected");
            p.classList.add("player-selectable");
          });
          rightPlayers.forEach((p) => {
            p.classList.remove(
              "player-disabled",
              "player-selected",
              "player-selectable"
            );
          });
          updateStartButton();
        }

        function randomizeChoice(leftPlayers, rightPlayers) {
          resetAll(leftPlayers, rightPlayers);

          // Randomly select a left player
          const randomLeftIndex = Math.floor(
            Math.random() * leftPlayers.length
          );
          leftPlayers[randomLeftIndex].click();

          // Randomly select an available right player
          const availableRightPlayers = rightPlayers.filter((p) =>
            p.classList.contains("player-selectable")
          );
          if (availableRightPlayers.length > 0) {
            const randomRightIndex = Math.floor(
              Math.random() * availableRightPlayers.length
            );
            availableRightPlayers[randomRightIndex].click();
          }
        }

        // Add event listeners for left players
        function attachLeftPlayerListeners(leftPlayers, rightPlayers) {
          leftPlayers.forEach((player, index) => {
            player.classList.add("player-selectable");

            player.addEventListener("click", () => {
              if (playersSelected >= 2) return;

              // Disable all left players initially
              leftPlayers.forEach((p) => {
                p.classList.add("player-disabled");
                p.classList.remove("player-selected");
              });

              // Select the clicked player
              player.classList.remove("player-disabled");
              player.classList.add("player-selected");
              leftSelectedIndex = index;
              if (playersSelected === 0) playersSelected++;

              // Enable or disable right players based on selection
              rightPlayers.forEach((rightPlayer, rightIndex) => {
                rightPlayer.classList.remove(
                  "player-disabled",
                  "player-selectable",
                  "player-selected"
                );

                // Enable only appropriate right players
                if (rightIndex !== index) {
                  rightPlayer.classList.add("player-selectable");
                } else {
                  rightPlayer.classList.add("player-disabled");
                }
              });

              updateStartButton();
            });
          });
        }

        // Add event listeners for right players
        function attachRightPlayerListeners(rightPlayers) {
          rightPlayers.forEach((player) => {
            player.addEventListener("click", () => {
              if (
                leftSelectedIndex !== null &&
                player.classList.contains("player-selectable") &&
                playersSelected < 2
              ) {
                playersSelected++;
                rightPlayers.forEach((p) => {
                  p.classList.remove("player-selectable");
                  p.classList.add("player-disabled");
                });

                player.classList.remove("player-disabled");
                player.classList.add("player-selected");
                updateStartButton();
              }
            });
          });
        }

        // Observe for changes in player cards dynamically
        const observer = new MutationObserver(() => {
          const leftPlayers = Array.from(
            leftGrid.querySelectorAll(".game-player-card-inner-single")
          );
          const rightPlayers = Array.from(
            rightGrid.querySelectorAll(".game-player-card-inner-single")
          );

          if (leftPlayers.length > 0 && rightPlayers.length > 0) {
            // observer.disconnect();
            attachLeftPlayerListeners(leftPlayers, rightPlayers);
            attachRightPlayerListeners(rightPlayers);

            // Allow external reset/randomization to function
            window.resetAll = () => resetAll(leftPlayers, rightPlayers);
            window.randomizeChoice = () =>
              randomizeChoice(leftPlayers, rightPlayers);

            // Initialize the start button state
            updateStartButton();
          }
        });

        // Start observing the grids for changes
        observer.observe(leftGrid, { childList: true, subtree: true });
        observer.observe(rightGrid, { childList: true, subtree: true });
      });
    </script>
  </body>
</html>